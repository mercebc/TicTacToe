<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Game.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">TicTacToe</a> &gt; <a href="index.source.html" class="el_package">game</a> &gt; <span class="el_source">Game.java</span></div><h1>Game.java</h1><pre class="source lang-java linenums">package game;

import com.Cli;
import players.PlayerFactory;
import players.Player;

import java.util.HashMap;
import java.util.InputMismatchException;
import java.util.Scanner;


public class Game {

  private Board board;
  private Cli cli;
  private PlayerFactory playerFactory;
  private HashMap&lt;Integer, String&gt; gameOptions;

  private Player player1;
  private Player player2;
  private Player currentPlayer;

<span class="fc" id="L23">  public static Scanner input = new Scanner(System.in);</span>

<span class="fc" id="L25">  public Game(Cli cli){</span>

<span class="fc" id="L27">    this.cli = cli;</span>
<span class="fc" id="L28">    this.board = new Board();</span>

<span class="fc" id="L30">    this.playerFactory = new PlayerFactory();</span>
<span class="fc" id="L31">    this.gameOptions = new HashMap&lt;Integer, String&gt;();</span>

<span class="fc" id="L33">    gameOptions.put(1, &quot;HUMAN-HUMAN&quot;);</span>
<span class="fc" id="L34">    gameOptions.put(2, &quot;HUMAN-COMPUTER&quot;);</span>
<span class="fc" id="L35">    gameOptions.put(3, &quot;COMPUTER-COMPUTER&quot;);</span>

<span class="fc" id="L37">    createPlayers(2);</span>
<span class="fc" id="L38">  }</span>

  public Player getPlayer1() {
<span class="fc" id="L41">    return player1;</span>
  }

  public Player getPlayer2() {
<span class="fc" id="L45">    return player2;</span>
  }

  public Player getCurrentPlayer() {
<span class="fc" id="L49">    return currentPlayer;</span>
  }

  public void setCurrentPlayer(Player currentPlayer) {
<span class="fc" id="L53">    this.currentPlayer = currentPlayer;</span>
<span class="fc" id="L54">  }</span>

  public Board getBoard() {
<span class="fc" id="L57">    return board;</span>
  }

  public void initGame(){

<span class="nc" id="L62">    System.out.println(&quot;Enter \&quot;1\&quot; for &quot; + player1.getName() + &quot; to start or \&quot;2\&quot; for &quot; + player2.getName() + &quot; to start&quot;);//Player choose who starts the game</span>

<span class="nc" id="L64">    whoStartsFirst(cli.askForIntegerBetweenMinAndMax(1,2));</span>

    do {
<span class="nc" id="L67">      int spot = getSpot();</span>

<span class="nc" id="L69">      setSpot(spot);</span>

<span class="nc" id="L71">      this.currentPlayer = nextPlayer(); //change players</span>

<span class="nc" id="L73">      cli.printBoard(board);</span>

<span class="nc bnc" id="L75" title="All 4 branches missed.">    } while (!this.board.threeInLine(player1, player2) &amp;&amp; !this.board.tie(player1, player2)); // repeat if not game-over</span>

<span class="nc" id="L77">    finalGameAnnouncements();</span>

<span class="nc" id="L79">    System.out.println(&quot;Enter \&quot;1\&quot; to Quit or \&quot;2\&quot; to Play again&quot;);//Player choose who starts the game</span>

<span class="nc" id="L81">    playAgain(cli.askForIntegerBetweenMinAndMax(1,2));</span>
<span class="nc" id="L82">  }</span>

  /** Initializes the game with player against computer. This is the default game if players haven't been changed */

  public void createPlayers(int key) {

<span class="fc" id="L88">    String option = gameOptions.get(key);</span>

<span class="fc" id="L90">    player1 = playerFactory.player1(option);</span>
<span class="fc" id="L91">    player2 = playerFactory.player2(option);</span>

<span class="fc" id="L93">  }</span>

  public void whoStartsFirst(int InputStream) {

    try{
<span class="fc bfc" id="L98" title="All 2 branches covered.">      if (InputStream == 1) {</span>
<span class="fc" id="L99">        currentPlayer = player1;</span>
<span class="pc bpc" id="L100" title="1 of 2 branches missed.">      } else if (InputStream == 2) {</span>
<span class="fc" id="L101">        currentPlayer = player2;</span>
      }
<span class="nc" id="L103">    } catch (IllegalArgumentException ex) {</span>
<span class="nc" id="L104">      System.out.println(ex.getMessage());</span>
<span class="nc" id="L105">      whoStartsFirst(InputStream);//recursive call when there is an exception</span>

<span class="nc" id="L107">    } catch (InputMismatchException ex) {</span>
<span class="nc" id="L108">      System.out.println(ex.getMessage());</span>
<span class="nc" id="L109">      whoStartsFirst(InputStream);</span>
<span class="pc" id="L110">    }</span>

<span class="fc" id="L112">  }</span>

  /** Change the player that is playing */
  public Player nextPlayer() {
<span class="fc bfc" id="L116" title="All 2 branches covered.">    if (currentPlayer == player1) {</span>
<span class="fc" id="L117">      return player2;</span>
    } else {
<span class="fc" id="L119">      return player1;</span>
    }
  }

  /** Get the spot of the player that is playing */
  public int getSpot(){

<span class="nc" id="L126">    return currentPlayer.getSpot(this.board, this.player1, this.player2, this.currentPlayer);//get the spot of the player, Human and Computer have different methods for this</span>

  }

  /** Set the spot that the player has chosen */
  public void setSpot(int spot){

<span class="fc" id="L133">    this.board.setCell(spot,this.currentPlayer.getSymbol());</span>

<span class="fc" id="L135">  }</span>

  /** Final Game Announcements */
  public void finalGameAnnouncements(){
<span class="nc bnc" id="L139" title="All 2 branches missed.">    if(this.board.tie(player1, player2)){</span>
<span class="nc" id="L140">      cli.announceTie();</span>
    }

<span class="nc bnc" id="L143" title="All 2 branches missed.">    if(this.board.checkLinePlayer(player1)){</span>
<span class="nc" id="L144">      cli.announceWinner(player1);</span>
    }

<span class="nc bnc" id="L147" title="All 2 branches missed.">    if(this.board.checkLinePlayer(player2)){</span>
<span class="nc" id="L148">      cli.announceWinner(player2);</span>
    }
<span class="nc" id="L150">  }</span>

  /** Player want to play again */
  public boolean playAgain(int InputStream) {

    try{

<span class="fc bfc" id="L157" title="All 2 branches covered.">      if (InputStream == 1) {</span>
<span class="fc" id="L158">        return false;</span>
<span class="pc bpc" id="L159" title="1 of 2 branches missed.">      } else if (InputStream == 2) {</span>
<span class="fc" id="L160">        return true;</span>
      }
<span class="nc" id="L162">    } catch (IllegalArgumentException ex) {</span>
<span class="nc" id="L163">      System.out.println(ex.getMessage());</span>
<span class="nc" id="L164">      playAgain(InputStream);//recursive call when there is an exception</span>

<span class="nc" id="L166">    } catch (InputMismatchException ex) {</span>
<span class="nc" id="L167">      System.out.println(ex.getMessage());</span>
<span class="nc" id="L168">      playAgain(InputStream);</span>
<span class="nc" id="L169">    }</span>

<span class="nc" id="L171">    return false;</span>
  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>